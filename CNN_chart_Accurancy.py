import matplotlib.pyplot as plt
import numpy as np
batch_sizes = [128, 4, 32, 16, 8, 512, 64]
data = [
[92.92, 96.66, 98.13, 97.02, 97.56, 89.01, 93.80],
[95.24, 97.86, 98.40, 97.50, 97.74, 90.66, 95.87],
[94.37, 97.41, 98.92, 97.80, 98.16, 92.92, 96.81],
[96.63, 95.57, 99.13, 97.71, 98.43, 93.58, 96.84],
[96.45, 98.92, 98.86, 97.83, 98.67, 94.28, 97.80],
[96.42, 98.83, 98.73, 98.34, 98.07, 94.46, 97.41],
[97.02, 97.41, 99.07, 98.34, 98.52, 95.21, 97.44],
[96.33, 98.64, 98.98, 98.43, 98.52, 95.24, 97.98],
[97.59, 99.04, 98.92, 98.49, 98.64, 95.45, 97.77],
[98.01, 99.28, 98.83, 98.40, 98.64, 96.27, 97.35],
[98.04, 99.28, 98.92, 98.58, 98.67, 96.51, 98.22],
[97.71, 95.60, 99.10, 98.46, 98.92, 96.27, 96.87],
[97.98, 99.13, 99.04, 98.49, 98.98, 96.78, 98.34],
[98.07, 99.34, 99.28, 97.35, 98.34, 96.81, 98.13],
[98.19, 99.25, 99.22, 98.58, 97.65, 97.11, 98.37],
[97.62, 99.40, 99.13, 98.46, 98.92, 96.99, 97.98],
[98.13, 98.01, 99.37, 98.95, 98.89, 97.23, 98.52],
[98.22, 99.25, 99.13, 99.25, 98.67, 96.81, 98.40],
[97.83, 99.31, 99.25, 99.28, 98.70, 97.14, 98.37],
[98.22, 99.37, 99.40, 99.13, 98.52, 97.32, 98.49],
[97.62, 99.28, 98.31, 99.31, 99.19, 97.32, 98.37],
[98.46, 99.10, 99.25, 99.19, 99.07, 97.68, 98.40],
[98.28, 99.34, 98.67, 98.98, 98.52, 97.44, 98.67],
[98.31, 99.04, 99.10, 99.22, 98.95, 97.71, 98.55],
[97.83, 99.52, 99.46, 99.19, 99.10, 97.44, 98.83],
[98.40, 99.16, 98.83, 99.28, 99.10, 97.62, 98.64],
[98.52, 99.46, 99.25, 98.80, 99.13, 97.74, 98.70],
[98.31, 99.43, 99.34, 99.19, 98.73, 97.71, 98.28],
[98.25, 99.46, 99.22, 99.31, 99.04, 97.62, 98.70],
[97.92, 99.43, 99.40, 99.13, 98.40, 97.59, 98.52],
[98.07, 99.70, 99.52, 99.10, 98.67, 98.01, 98.83],
[97.95, 99.73, 99.58, 99.10, 99.19, 97.59, 98.73],
[98.34, 99.70, 99.43, 99.01, 99.16, 98.10, 98.83],
[98.58, 99.40, 99.22, 99.40, 98.98, 98.31, 98.80],
[98.37, 99.31, 99.49, 99.19, 99.04, 98.49, 98.80],
[98.55, 99.43, 99.40, 99.10, 98.92, 97.77, 99.13],
[98.70, 99.31, 99.61, 99.43, 99.19, 97.08, 98.86],
[98.55, 98.80, 99.34, 99.49, 99.04, 98.22, 98.77],
[98.49, 99.58, 99.31, 99.22, 98.73, 97.86, 97.89],
[98.67, 99.40, 99.28, 99.46, 98.83, 98.40, 98.92],
]

data = np.array(data)  

epochs = np.arange(1, data.shape[0] + 1)

plt.figure(figsize=(14, 7))
colors = ['blue', 'orange', 'green', 'red', 'purple', 'brown', 'pink']

for i, batch in enumerate(batch_sizes):
plt.plot(epochs, data[:, i], label=f'Batch {batch}', color=colors[i])

plt.xlabel('Эпохи')
plt.ylabel('Процент (%)')
plt.title('Зависимость точности от размера batch на каждой эпохе')
plt.legend()
plt.grid(True)
plt.tight_layout()
plt.show()
plt.savefig('batch_accuracy_vs_epoch.png', dpi=300)
